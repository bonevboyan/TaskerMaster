@using Taskord.Services.Chats.Models
@model ChatListViewModel

<div class="col-12 col-lg-5 col-xl-3 border-right">

    <div class="px-4 d-none d-md-block">
        <div class="d-flex align-items-center">
            <div class="flex-grow-1">
                <input type="text" class="form-control my-3" placeholder="Search...">
            </div>
        </div>
    </div>

    @foreach (var chat in Model.Chats)
    {
        <a asp-controller="Chats" asp-action="Get" asp-route-chatId="@chat.Id" asp-route-teamId="@Model.TeamId" class="list-group-item list-group-item-action border-0@(chat.IsSelected ? " selected-chat": string.Empty)">
            @*<div class="badge bg-success float-right">5</div>*@
            <div class="d-flex align-items-start">
                @*<img src="https://bootdey.com/img/Content/avatar/avatar5.png" class="rounded-circle mr-1" alt="@chat.Name" width="40" height="40">*@
                <div class="flex-grow-1 ml-3">
                    @if (chat.IsRead)
                    {
                        <h6>@chat.Name</h6>
                    }
                    else
                    {
                        <h6><strong>@chat.Name</strong></h6>
                        <span class="dot">New</span>
                    }
                    <div class="small fst-italic">
                        <span class="fas fa-circle chat-online"></span>
                        @if (chat.LastMessageSent != null)
                        {
                            @("(" + (chat.LastMessageSent.DateTime) + ") " + (chat.LastMessageSent.IsOwn
                    ? "You: "
                    : chat.LastMessageSent.Sender.Username + ": ") + chat.LastMessageSent.Content)
                        }
                        else
                        {
                            @("No messages yet")
                        }
                    </div>
                </div>
            </div>
        </a>
    }

    @if (Model.IsAdmin)
    {
        <a asp-controller="Chats" asp-action="Create" asp-route-teamId="@Model.TeamId" class="list-group-item list-group-item-action border-0">
            <div class="d-flex align-items-start">
                <h6>Add New Chat</h6>
            </div>
        </a>
    }

    <hr class="d-block d-lg-none mt-1 mb-0">
</div>